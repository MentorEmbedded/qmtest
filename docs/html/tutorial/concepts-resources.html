<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>7. Resources</title><link rel="stylesheet" type="text/css" href="cs.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="QMTest: User's Guide"><link rel="up" href="concepts.html" title="Chapter 1. QMTest Concepts"><link rel="prev" href="concepts-context.html" title="6. Context"><link rel="next" href="concepts-targets.html" title="8. Targets"><link rel="copyright" href="ln-id335742.html" title="Legal Notice"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">7. Resources</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="concepts-context.html">Prev</a> </td><th width="60%" align="center">Chapter 1. <span class="application">QMTest</span> Concepts</th><td width="20%" align="right"> <a accesskey="n" href="concepts-targets.html">Next</a></td></tr></table><hr></div><div class="section" title="7. Resources"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="concepts-resources"></a>7. Resources</h2></div></div></div><p>Some tests take a lot of work to set up. For example, a database
    test that checks the result of SQL queries may require that the database
    first be populated with a substantial number of records. If there are many
    tests that all use the same set of records, it would be wasteful to set up
    the database for each test. It would be more efficient to set up the
    database once, run all of the tests, and then remove the databases upon
    completion.</p><p>You can use a <em class="firstterm">resource</em> to gain this
    efficiency. If a test depends on a resource,
    <span class="application">QMTest</span> will ensure that the resource is
    available before the test runs. Once all tests that depend on the resource
    have been run <span class="application">QMTest</span> will destroy the
    resource.</p><p>Just as every test is an instance of a <em class="firstterm">test
    class</em>, every resource is an instance of a <em class="firstterm">resource
    class</em>. The resource class explains how to set up the resource
    and how to clean up when it is no longer needed. The arguments to the
    resource class are what make two instances of the same resource class
    different from each other. For example, in the case of a resource that
    sets up a database, the records to place in the database might be given as
    arguments. Every resource has a name, using the same format that is used
    for tests.</p><p>Under some circumstances (such as running tests on multiple 
    <a class="link" href="concepts-targets.html" title="8. Targets">targets</a> at once),
    <span class="application">QMTest</span> may create more than one
    instance of the same resource. Therefore, you should never depend on there
    being only one instance of a resource. In addition, if you have asked
    <span class="application">QMTest</span> to run tests concurrently, two tests may
    access the same resource at the same time. You can, however, be assured
    that there will be only one instance of a particular resource on a
    particular target at any one time.</p><p>Tests have limited access to the resources on which they depend. A
    resource may place additional information into the context (<a class="xref" href="concepts-context.html" title="6. Context">Section 6, &#8220;Context&#8221;</a>) that is visible to the test. However, the
    actual resource object itself is not available to tests. (The reason for
    this limitiation is that for a target consisting of multiple processes,
    the resource object may not be located in the same process as the test that
    depends upon it.)</p><p>Setting up or cleaning up a resource produces a result, just like
    those produced for tests. <span class="application">QMTest</span> will display
    these results in its summary output and record them in the results
    file.</p><p>Building on the previous example of a CompilationTest, let us
      consider a situation where some test application should be run multiple
      times with different arguments. The test application, however, needs to
      be compiled first. In order to avoid recompiling the application for each
      test, you can create a resource that compiles the application once.  Then,
      tests that depend on this resource can assume that the application has 
      already been built.  The following commands:</p><pre class="screen">
<code class="prompt">&gt; </code><strong class="userinput"><code>qmtest create --id applet resource
    compilation_test.CompiledResource(executable="applet", source_files="['/path/to/applet.cc']")</code></strong>
<code class="prompt">&gt; </code><strong class="userinput"><code>qmtest create --id run_applet_0 test
    compilation_test.ExecutableTest(args="['0']", resources="['applet']")</code></strong>
<code class="prompt">&gt; </code><strong class="userinput"><code>qmtest create --id run_applet_1 test
    compilation_test.ExecutableTest(args="['1']", resources="['applet']")</code></strong>
    </pre><p>create a resource (named "applet") for the application and two tests
    ("run_applet_0" and "run_applet_1"), both of which make use of
    "applet", but which pass it different command-line options.</p><pre class="screen">
<code class="prompt">&gt; </code><strong class="userinput"><code>qmtest run -c CompilationTest.compiler_path=g++ run_applet_0 run_applet_1</code></strong>
--- TEST RESULTS -------------------------------------------------------------

  Setup applet                                  : PASS

  run_applet_0                                  : PASS

  run_applet_1                                  : PASS

  Cleanup applet                                : PASS
    </pre></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="concepts-context.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="concepts.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="concepts-targets.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">6. Context </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 8. Targets</td></tr></table></div></body></html>
